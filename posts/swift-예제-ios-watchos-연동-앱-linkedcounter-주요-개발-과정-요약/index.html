<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)" />
<meta property="og:locale" content="ko" />
<meta name="description" content="Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter" />
<meta property="og:description" content="Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter" />
<link rel="canonical" href="https://ayaysir.github.io/posts/swift-%EC%98%88%EC%A0%9C-ios-watchos-%EC%97%B0%EB%8F%99-%EC%95%B1-linkedcounter-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%B0%9C-%EA%B3%BC%EC%A0%95-%EC%9A%94%EC%95%BD/" />
<meta property="og:url" content="https://ayaysir.github.io/posts/swift-%EC%98%88%EC%A0%9C-ios-watchos-%EC%97%B0%EB%8F%99-%EC%95%B1-linkedcounter-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%B0%9C-%EA%B3%BC%EC%A0%95-%EC%9A%94%EC%95%BD/" />
<meta property="og:site_name" content="BGSMM" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-27T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)" />
<meta name="google-site-verification" content="pvY2wZTkfhJgJGUCvK9k0h-YX3Be3V-u1J4pE6FriWA" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-27T00:00:00+09:00","datePublished":"2022-09-27T00:00:00+09:00","description":"Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter","headline":"Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)","mainEntityOfPage":{"@type":"WebPage","@id":"https://ayaysir.github.io/posts/swift-%EC%98%88%EC%A0%9C-ios-watchos-%EC%97%B0%EB%8F%99-%EC%95%B1-linkedcounter-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%B0%9C-%EA%B3%BC%EC%A0%95-%EC%9A%94%EC%95%BD/"},"url":"https://ayaysir.github.io/posts/swift-%EC%98%88%EC%A0%9C-ios-watchos-%EC%97%B0%EB%8F%99-%EC%95%B1-linkedcounter-%EC%A3%BC%EC%9A%94-%EA%B0%9C%EB%B0%9C-%EA%B3%BC%EC%A0%95-%EC%9A%94%EC%95%BD/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약) | BGSMM
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="BGSMM">
<meta name="application-name" content="BGSMM">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>

  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/./assets/img/favicons/mstile-150x150.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">BGSMM</a>
    <p class="site-subtitle fst-italic mb-0">음악, 레트로테크 좋아함</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/ayaysir"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['yoonbumtae','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1664204400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 27, 2022
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/ayaysir">ayaysir</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="5437 words"
>
  <em>30 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter (주요 개발 과정 요약)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p><strong>Swift 예제: iOS + WatchOS 연동 앱 LinkedCounter</strong></p>

<h2 id="전체-코드"><span class="me-2"><strong>전체 코드</strong></span><a href="#전체-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li><a href="https://github.com/ayaysir/LinkedCounter">https://github.com/ayaysir/LinkedCounter</a></li>
</ul>

<p> </p>

<h2 id="개발-환경"><span class="me-2"><strong>개발 환경</strong></span><a href="#개발-환경" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>Xcode 13.3.1, Swift 5</li>
  <li>iOS App with Watch App 템플릿</li>
  <li>Storyboard Interface (워치 앱에 부분적으로 SwiftUI 사용)</li>
</ul>

<p> </p>

<h2 id="목적"><span class="me-2"><strong>목적</strong></span><a href="#목적" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>워치용 앱 기본 개발 학습</li>
  <li>아이폰 앱 워치 앱 간 데이터 연동 방법 학습</li>
  <li>컴플리케이션(Complication) 기본 개발 학습</li>
</ul>

<p> </p>

<h2 id="필수-참고-글"><span class="me-2"><strong>필수 참고 글</strong></span><a href="#필수-참고-글" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li><strong><em>워치 앱 개발의 기본 방법 및 아이폰 앱 - 워치 앱간 통신</em></strong>
    <ul>
      <li><a href="https://litoarias.medium.com/watchos-5-communication-between-iphone-and-apple-watch-and-vice-versa-63d4c8306fc0">WatchOS 5 — Communication between iPhone and Apple Watch and vice versa on Swift</a> (Part 1 ~ 3)</li>
    </ul>
  </li>
  <li><strong><em>컴플리케이션 제작 방법</em></strong>
    <ul>
      <li><a href="https://www.raywenderlich.com/17749320-complications-for-watchos-with-swiftui">Complications for watchOS With SwiftUI</a></li>
    </ul>
  </li>
  <li><strong><em>컴플리케이션 애플 공식 문서</em></strong>
    <ul>
      <li><a href="https://developer.apple.com/documentation/clockkit/creating_complications_for_your_watchos_app">Creating Complications for Your watchOS App</a></li>
    </ul>
  </li>
</ul>

<p> </p>

<p>이 글은 설명글이 아니고 개인적인 복습을 위해 주요 내용을 요약한 글입니다. 애플 워치 개발에 관한 설명글은 위의 글들을 번역해서 따로 올리도록 하겠습니다.</p>

<p> </p>

<h2 id="동작-내용"><span class="me-2"><strong>동작 내용</strong></span><a href="#동작-내용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>기본적으로 버튼을 누르면 숫자가 증감하는 카운터 앱입니다.</li>
  <li>모든 데이터는 아이폰 앱에서 <code class="language-plaintext highlighter-rouge">UserDefaults</code>로 관리됩니다.</li>
  <li>애플 워치 앱은 아이폰과 연결해 아이폰 내부의 <code class="language-plaintext highlighter-rouge">UserDefaults</code> 정보를 통신으로 받아오고 정보를 표시합니다.</li>
  <li>아이폰의 전원이 꺼지지 않는 한 앱이 백그라운드 모드이거나 꺼져있어도 서로 정보를 통신하고 동기화할 수 있습니다.</li>
</ul>

<p> </p>

<ul>
  <li>아이폰 앱에서 숫자를 증감시키면 애플 워치 앱에 실시간으로 반영됩니다.</li>
</ul>

<!-- http://www.giphy.com/gifs/joWqzA74ih34OYPjN2 -->
<p><a href="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExazN0M3dwdzRxc3lsaDZ2YWlmaWszOWc0am0xYzBqYXUxbmp4Z2luOSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/joWqzA74ih34OYPjN2/giphy.gif" class="popup img-link shimmer"><img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExazN0M3dwdzRxc3lsaDZ2YWlmaWszOWc0am0xYzBqYXUxbmp4Z2luOSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/joWqzA74ih34OYPjN2/giphy.gif" alt="" loading="lazy"></a></p>

<p> </p>

<ul>
  <li>반대로 애플워치 앱에서 숫자를 증감시켜도 아이폰 앱에서 실시간으로 반영됩니다.</li>
  <li>이 때 통신상태 불량으로 인한 데이터 불일치를 방지하기 위해 싱크 검증 기능이 있습니다.</li>
</ul>

<!-- http://www.giphy.com/gifs/Gay28hfApiqpELQ7Kk -->
<p><a href="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnI2MTU2bjhueTJ2bjUxaG5tMjh6eDZsZXZzeTNoNGpjam1oMThreSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Gay28hfApiqpELQ7Kk/giphy.gif" class="popup img-link shimmer"><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnI2MTU2bjhueTJ2bjUxaG5tMjh6eDZsZXZzeTNoNGpjam1oMThreSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Gay28hfApiqpELQ7Kk/giphy.gif" alt="" loading="lazy"></a></p>

<p><em>(시뮬레이터는 통신 속도가 느려 싱크 과정에서 딜레이가 있습니다.)</em></p>

<p> </p>

<ul>
  <li>현재 카운트 수 및 <code class="language-plaintext highlighter-rouge">현재 카운트 수 / 목표 수치</code>의 진행율을 표시하는 컴플리케이션 기능(<code class="language-plaintext highlighter-rouge">CLKComplicationTemplateCircularSmallRingText</code>)이 있습니다.</li>
</ul>

<!-- http://www.giphy.com/gifs/mgZnzfzjFvdZTpEZlz -->
<p><a href="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdGdkbm9tbG94Z3VydjJ4eXg3ejB2MjVucWZkZnI4OTcwMmp4aDVvaCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/mgZnzfzjFvdZTpEZlz/giphy.gif" class="popup img-link shimmer"><img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdGdkbm9tbG94Z3VydjJ4eXg3ejB2MjVucWZkZnI4OTcwMmp4aDVvaCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/mgZnzfzjFvdZTpEZlz/giphy.gif" alt="" loading="lazy"></a></p>

<p>1000으로 목표 수치 설정</p>

<p> </p>

<!-- http://www.giphy.com/gifs/4U2ZIdxnTkaPtPwWI7 -->
<p><a href="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExanBjZmVzdmtzczBjcnRjZjlydDluZTVqb3Bnd3BxZ3FiZGFxMDI3NiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" class="popup img-link shimmer"><img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExanBjZmVzdmtzczBjcnRjZjlydDluZTVqb3Bnd3BxZ3FiZGFxMDI3NiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" alt="" loading="lazy"></a></p>

<p><code class="language-plaintext highlighter-rouge">현재 카운트 수 / 목표 수치 = 450 / 1000 = 45%</code> 분량의 진행율이 프로그레스 링으로 표시</p>

<p> </p>

<!-- http://www.giphy.com/gifs/7Yb7hHjaeWGMVqvRrE -->
<p><a href="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExcXBzdThqd2p2dnd2NWZtM2swM3R3YmJkczA1dnowZnh5b2l6cm5uaCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" class="popup img-link shimmer"><img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExcXBzdThqd2p2dnd2NWZtM2swM3R3YmJkczA1dnowZnh5b2l6cm5uaCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" alt="" loading="lazy"></a></p>

<p><em>카운트 수가 1000이 넘으면 <code class="language-plaintext highlighter-rouge">1K</code>로 표시</em> <em>(<code class="language-plaintext highlighter-rouge">CLKComplicationTemplateCircularSmallRingText</code>의 표시 자리수 한계 방지를 위함)</em></p>

<p> </p>

<h2 id="주요-과정-정리"><span class="me-2"><strong>주요 과정 정리</strong></span><a href="#주요-과정-정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="1-사전-작업"><span class="me-2"><strong>1) 사전 작업</strong></span><a href="#1-사전-작업" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>시뮬레이터에서 아이폰 디바이스와 워치 모델을 연결시켜야 합니다.</li>
</ul>

<p><a href="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-23-pm-10.02.38.jpg" class="popup img-link shimmer"><img src="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-23-pm-10.02.38.jpg" alt="" loading="lazy"></a></p>

<p> </p>

<h3 id="2-아이폰-앱-개발"><span class="me-2"><strong>2) 아이폰 앱 개발</strong></span><a href="#2-아이폰-앱-개발" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>먼저 애플 워치를 고려하지 않고 아이폰 단독 앱을 개발합니다. 스토리보드 구조는 아래와 같습니다.</li>
</ul>

<p><a href="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-28-am-12.09.37.jpg" class="popup img-link shimmer"><img src="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-28-am-12.09.37.jpg" alt="" loading="lazy"></a></p>

<p> </p>

<h3 id="3-워치-앱-ui-디자인"><span class="me-2"><strong>3) 워치 앱 UI 디자인</strong></span><a href="#3-워치-앱-ui-디자인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>다음, 워치 앱을 개발합니다.</li>
  <li>워치 앱은 개발 요소에 제약이 있습니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">UIView</code>가 없고, 추가할 수 있는 UI Component 종류의 수도 적습니다.</li>
      <li>Constraint 개념이 없고, 요소를 수직으로만 쌓을 수 있습니다.</li>
      <li><code class="language-plaintext highlighter-rouge">@IBAction</code> 연결 시 <code class="language-plaintext highlighter-rouge">sender</code> 파라미터가 없습니다.</li>
      <li>그 외 레이블로부터 텍스트를 가져올 수 없고 설정만 가능한 것 등</li>
    </ul>
  </li>
  <li>워치 부분(WatchKit)은 <code class="language-plaintext highlighter-rouge">App</code>과 <code class="language-plaintext highlighter-rouge">Extension</code>으로 나뉘어 있습니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">WatchKit App</code>은 스토리보드처럼 UI 표시 부분만 담당합니다.</li>
      <li><code class="language-plaintext highlighter-rouge">WatchKit Extension</code>은 컨트롤러가 모여있는 부분으로 Inerface, Notification, Complication 등의 데이터를 관리하고 UI 측(WatchKit App)에 전달합니다.</li>
    </ul>
  </li>
  <li>Label과 Button만 이용해 아래 UI 요소를 <code class="language-plaintext highlighter-rouge">Interface Controller Scene</code>에 추가합니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Interfaces</code>는 앱을 열었을 때 바로 첫 화면을 표시하는 부분입니다.</li>
      <li>여기서 UI 컴포넌트를 추가하고, 연동 작업은 WatchKit Extension의 <strong><em>InterfaceController.swift</em></strong>에서 작성합니다.</li>
    </ul>
  </li>
</ul>

<p><a href="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-28-am-12.16.11.jpg" class="popup img-link shimmer"><img src="/assets/img/wp-content/uploads/2022/09/screenshot-2022-09-28-am-12.16.11.jpg" alt="" loading="lazy"></a></p>

<p> </p>

<ul>
  <li><strong><em>InterfaceController.swift</em></strong> 중 UI 관련된 부분 코드</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
</pre></td><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">WatchKit</span>
<span class="kd">import</span> <span class="kt">Foundation</span>
<span class="kd">import</span> <span class="kt">WatchConnectivity</span>
<span class="kd">import</span> <span class="kt">ClockKit</span>

<span class="kd">class</span> <span class="kt">InterfaceController</span><span class="p">:</span> <span class="kt">WKInterfaceController</span> <span class="p">{</span>
    
    <span class="kd">enum</span> <span class="kt">LabelStatus</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">stepValue</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">error</span>
    <span class="p">}</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">lblTotalCount</span><span class="p">:</span> <span class="kt">WKInterfaceLabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">lblStatus</span><span class="p">:</span> <span class="kt">WKInterfaceLabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">btnMinus</span><span class="p">:</span> <span class="kt">WKInterfaceButton</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">btnPlus</span><span class="p">:</span> <span class="kt">WKInterfaceButton</span><span class="o">!</span>

    <span class="kd">private</span> <span class="k">var</span> <span class="nv">totalCount</span><span class="p">:</span> <span class="kt">Double</span><span class="o">!</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">plusCount</span><span class="p">:</span> <span class="kt">Double</span><span class="o">!</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">initTotalCountLoaded</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">initPlusCountLoaded</span> <span class="o">=</span> <span class="kc">false</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awake</span><span class="p">(</span><span class="n">withContext</span> <span class="nv">context</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?)</span> <span class="p">{</span>
        <span class="c1">// Configure interface objects here.</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">willActivate</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// This method is called when watch view controller is about to be visible to user</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">didDeactivate</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// This method is called when watch view controller is no longer visible    }</span>
    
    <span class="c1">// MARK: - UI Helper</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">turnAllButton</span><span class="p">(</span><span class="n">_</span> <span class="nv">isEnable</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">btnPlus</span><span class="o">.</span><span class="nf">setEnabled</span><span class="p">(</span><span class="n">isEnable</span><span class="p">)</span>
        <span class="n">btnMinus</span><span class="o">.</span><span class="nf">setEnabled</span><span class="p">(</span><span class="n">isEnable</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">_</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="kt">UIColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">lblTotalCount</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">lblTotalCount</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setStatus</span><span class="p">(</span><span class="n">_</span> <span class="nv">status</span><span class="p">:</span> <span class="kt">LabelStatus</span><span class="p">,</span> <span class="n">_</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">status</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">stepValue</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="s">"Step Value: </span><span class="se">\(</span><span class="n">text</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">normal</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">error</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">red</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">text</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - @IBActions</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActRefresh</span><span class="p">()</span> <span class="p">{</span>
       <span class="nf">fetchDataFromRootDevice</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActMinus</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">)</span>
        <span class="c1">// 시계 디스플레이는 plusCount 만큼 일단 올리고</span>
        <span class="c1">// 맞으면 확정 표시</span>
        <span class="c1">// 틀리면 롤백</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">-</span> <span class="n">plusCount</span>
        <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">darkGray</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActPlus</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">)</span>
        <span class="c1">// 시계 디스플레이는 plusCount 만큼 일단 올리고</span>
        <span class="c1">// 맞으면 확정 표시</span>
        <span class="c1">// 틀리면 롤백</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">+</span> <span class="n">plusCount</span>
        <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">darkGray</span><span class="p">)</span>
        <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Syncing..."</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>시뮬레이터로 빌드 및 실행합니다. 기능은 동작하지 않지만 버튼 및 레이블은 정상적으로 표시되어야 합니다.</li>
</ul>

<p> </p>

<h3 id="4-아이폰-앱---워치-앱-통신-구현"><span class="me-2"><strong>4) 아이폰 앱 - 워치 앱 통신 구현</strong></span><a href="#4-아이폰-앱---워치-앱-통신-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="애플-워치에서-아이폰으로-요청"><span class="me-2"><strong>애플 워치에서 아이폰으로 요청</strong></span><a href="#애플-워치에서-아이폰으로-요청" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li><strong><em>InterfaceController.swift</em></strong>의 멤버 변수 및 <code class="language-plaintext highlighter-rouge">willActivate()</code>에 다음 코드를 추가합니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">WCSession</code>은 아이폰 워치가 통신할 수 있도록 하는 매개체입니다.</li>
      <li><code class="language-plaintext highlighter-rouge">willActivate()</code> 안에는 앱을 열었을 때 실행해야할 동작을 지정합니다.</li>
    </ul>
  </li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">// 1: Session property</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">WCSession</span><span class="o">.</span><span class="k">default</span>

<span class="k">override</span> <span class="kd">func</span> <span class="nf">willActivate</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// This method is called when watch view controller is about to be visible to user</span>
    
    <span class="c1">// 2: Initialization of session and set as delegate this InterfaceController if it's supported</span>
    <span class="k">if</span> <span class="kt">WCSession</span><span class="o">.</span><span class="nf">isSupported</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">session</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">session</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<ul>
  <li>먼저 워치의 <strong><em>InterfaceController.swift</em></strong>에서 아이폰 앱에 요청(<code class="language-plaintext highlighter-rouge">request</code>)을 보내고 응답(<code class="language-plaintext highlighter-rouge">response</code>)을 받는 코드를 작성합니다..</li>
  <li><code class="language-plaintext highlighter-rouge">session.sendMessage(...)</code> 메서드를 이용합니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">["request": "totalCount_get"]</code>이라는 메시지를 아이폰 앱으로 보냅니다.</li>
    </ul>
  </li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">_</span> <span class="nv">message</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">],</span> 
                   <span class="nv">replyHandler</span><span class="p">:</span> <span class="p">(([</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?,</span> 
                   <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">((</span><span class="kt">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequest</span><span class="p">(</span><span class="s">"totalCount_get"</span><span class="p">))</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"response"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">initTotalCountLoaded</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="c1">// Set CurrentData</span>
        <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
        <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">initPlusCountLoaded</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="nf">turnAllButton</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="s">"ERROR"</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">red</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending message: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="s">"ERROR"</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">red</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<ul>
  <li>다음 아이폰에서 워치측의 요청을 처리하는 코드를 작성합니다.</li>
  <li>아이폰 프로젝트에 <strong><em>SessionHandler.swift</em></strong> 파일을 생성하고 아래 코드를 추가합니다.</li>
  <li><code class="language-plaintext highlighter-rouge">WCSessionDelegate</code>의 <code class="language-plaintext highlighter-rouge">extension</code> 안에 있는 <code class="language-plaintext highlighter-rouge">func session(...didReceiveMessage...)</code> 부분이 요청을 처리하는 곳입니다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre></td><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">Foundation</span>
<span class="kd">import</span> <span class="kt">WatchConnectivity</span>

<span class="kd">class</span> <span class="kt">SessionHandler</span> <span class="p">:</span> <span class="kt">NSObject</span><span class="p">,</span> <span class="kt">WCSessionDelegate</span> <span class="p">{</span>
    
    <span class="c1">// 1: Singleton</span>
    <span class="kd">static</span> <span class="k">let</span> <span class="nv">shared</span> <span class="o">=</span> <span class="kt">SessionHandler</span><span class="p">()</span>
    
    <span class="c1">// 2: Property to manage session</span>
    <span class="k">var</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">WCSession</span><span class="o">.</span><span class="k">default</span>
    
    <span class="k">override</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">()</span>
        
        <span class="c1">// 3: Start and activate session if it's supported</span>
        <span class="k">if</span> <span class="kt">WCSession</span><span class="o">.</span><span class="nf">isSupported</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">session</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
            <span class="n">session</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="s">"isPaired?: </span><span class="se">\(</span><span class="n">session</span><span class="o">.</span><span class="n">isPaired</span><span class="se">)</span><span class="s">, isWatchAppInstalled?: </span><span class="se">\(</span><span class="n">session</span><span class="o">.</span><span class="n">isWatchAppInstalled</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">isSupported</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="kt">WCSession</span><span class="o">.</span><span class="nf">isSupported</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - WCSessionDelegate</span>
    
    <span class="c1">// 4: Required protocols</span>
    
    <span class="c1">// a</span>
    <span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">activationDidCompleteWith</span> <span class="nv">activationState</span><span class="p">:</span> <span class="kt">WCSessionActivationState</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">Error</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"activationDidCompleteWith activationState:</span><span class="se">\(</span><span class="n">activationState</span><span class="se">)</span><span class="s"> error:</span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// b</span>
    <span class="kd">func</span> <span class="nf">sessionDidBecomeInactive</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"sessionDidBecomeInactive: </span><span class="se">\(</span><span class="n">session</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// c</span>
    <span class="kd">func</span> <span class="nf">sessionDidDeactivate</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"sessionDidDeactivate: </span><span class="se">\(</span><span class="n">session</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="c1">// Reactivate session</span>
        <span class="cm">/**
         * This is to re-activate the session on the phone when the user has switched from one
         * paired watch to second paired one. Calling it like this assumes that you have no other
         * threads/part of your code that needs to be given time before the switch occurs.
         */</span>
        <span class="k">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// Observer to receive messages from watch and we be able to response it</span>
    <span class="c1">///</span>
    <span class="c1">/// - Parameters:</span>
    <span class="c1">///   - session: session</span>
    <span class="c1">///   - message: message received</span>
    <span class="c1">///   - replyHandler: response handler</span>
    <span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">didReceiveMessage</span> <span class="nv">message</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">],</span> <span class="nv">replyHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">([</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">request</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"request"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="k">switch</span> <span class="n">request</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s">"plusCount_get"</span><span class="p">:</span>
            <span class="nf">replyHandler</span><span class="p">(</span><span class="nf">makeResponse</span><span class="p">(</span><span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgPlusCount</span><span class="p">)))</span>
        <span class="k">case</span> <span class="s">"totalCount_get"</span><span class="p">:</span>
            <span class="nf">replyHandler</span><span class="p">(</span><span class="nf">makeResponse</span><span class="p">(</span><span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTotalCount</span><span class="p">)))</span>
        <span class="k">case</span> <span class="s">"totalCount_plus"</span><span class="p">:</span>
            <span class="k">let</span> <span class="nv">oldValue</span> <span class="o">=</span> <span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTotalCount</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgPlusCount</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">newValue</span> <span class="o">=</span> <span class="n">oldValue</span> <span class="o">+</span> <span class="p">(</span><span class="n">plusCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nv">plusCount</span> <span class="p">:</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="n">localStorage</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTotalCount</span><span class="p">)</span>
            <span class="nf">replyHandler</span><span class="p">(</span><span class="nf">makeResponse</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span>
            <span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">refreshView</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="k">case</span> <span class="s">"totalCount_minus"</span><span class="p">:</span>
            <span class="k">let</span> <span class="nv">oldValue</span> <span class="o">=</span> <span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTotalCount</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgPlusCount</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">newValue</span> <span class="o">=</span> <span class="n">oldValue</span> <span class="o">-</span> <span class="p">(</span><span class="n">plusCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="nv">plusCount</span> <span class="p">:</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="n">localStorage</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTotalCount</span><span class="p">)</span>
            <span class="nf">replyHandler</span><span class="p">(</span><span class="nf">makeResponse</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span>
            <span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="o">.</span><span class="n">refreshView</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="k">case</span> <span class="s">"targetCount_get"</span><span class="p">:</span>
            <span class="nf">replyHandler</span><span class="p">(</span><span class="nf">makeResponse</span><span class="p">(</span><span class="n">localStorage</span><span class="o">.</span><span class="nf">double</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">cfgTargetCount</span><span class="p">)))</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">sendDataForComplication</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">isReachable</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">isReachable</span> <span class="p">{</span>
            <span class="n">session</span><span class="o">.</span><span class="nf">transferCurrentComplicationUserInfo</span><span class="p">([</span><span class="s">"request"</span><span class="p">:</span> <span class="s">"forComplication"</span><span class="p">])</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">["request": "totalCount_get"]</code>라는 메시지를 받은 아이폰 앱은
    <ul>
      <li><code class="language-plaintext highlighter-rouge">guard let request = message["request"]</code> 를 통과하고</li>
      <li><code class="language-plaintext highlighter-rouge">switch request</code>문에서 <code class="language-plaintext highlighter-rouge">"totalCount_get"</code> 부분을 찾은 뒤</li>
      <li><code class="language-plaintext highlighter-rouge">replyHandler([String:Any])</code>를 이용해 워치 앱 측으로 <code class="language-plaintext highlighter-rouge">["response": 현재카운트]</code> 응답을 보냅니다.</li>
      <li>해당 응답을 받은 워치 앱은 응답 내용을 바탕으로 워치 앱에 정보를 표시합니다.</li>
    </ul>
  </li>
</ul>

<p> </p>

<h4 id="아이폰에서-애플-워치로-요청"><span class="me-2"><strong>아이폰에서 애플 워치로 요청</strong></span><a href="#아이폰에서-애플-워치로-요청" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>데이터는 전부 아이폰에서 관리하기 때문에 아이폰에서 애플워치르 보낼 때엔 request만 필요하고 response는 받을 필요가 없습니다.</li>
</ul>

<p> </p>

<ul>
  <li>아이폰 프로젝트의 뷰 컨트롤러 클래스 안에 멤버변수로 다음을 추가합니다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">// 1: Get singleton class whitch manage WCSession</span>
<span class="k">var</span> <span class="nv">connectivityHandler</span> <span class="o">=</span> <span class="kt">SessionHandler</span><span class="o">.</span><span class="n">shared</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<ul>
  <li>요청이 필요한 순간에 session.sendMessage(…replyHandler…)를 사용합니다.
    <ul>
      <li>예) 버튼을 눌렀을 때</li>
    </ul>
  </li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">connectivityHandler</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequestForSendToWatch</span><span class="p">(</span><span class="nv">totalCount</span><span class="p">:</span> <span class="n">stepperTotalCount</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nv">plusCount</span><span class="p">:</span> <span class="n">stepperPlusCount</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="nv">replyHandler</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending message: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">makeRequestForSendToWatch</span><span class="p">(</span><span class="nv">totalCount</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span> <span class="nv">plusCount</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span> <span class="nv">targetCount</span><span class="p">:</span> <span class="kt">Double</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"totalCount"</span><span class="p">:</span> <span class="n">totalCount</span><span class="p">,</span>
        <span class="s">"plusCount"</span><span class="p">:</span> <span class="n">plusCount</span><span class="p">,</span>
    <span class="p">]</span>
    
    <span class="k">if</span> <span class="k">let</span> <span class="nv">targetCount</span> <span class="o">=</span> <span class="n">targetCount</span> <span class="p">{</span>
        <span class="n">dict</span><span class="p">[</span><span class="s">"targetCount"</span><span class="p">]</span> <span class="o">=</span> <span class="n">targetCount</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">dict</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<ul>
  <li>애플 워치의 인터페이스 컨트롤러의 WCSessionDelegate 확장 안에 아이폰으로부터 받은 요청을 처리하는 코드를 작성합니다.</li>
  <li>요청값을 받으면, 그 값으로 레이블을 최신 정보로 업데이트합니다.</li>
  <li>만약 아이폰으로 응답을 보낼 필요가 있다면, <code class="language-plaintext highlighter-rouge">WCSessionDelegate.session(_:didReceiveMessage:replyHandler:)</code>.를 사용합니다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1">// Receive messages from iPhone</span>
<span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">didReceiveMessage</span> <span class="nv">message</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// 1: We launch a sound and a vibration</span>
    <span class="kt">WKInterfaceDevice</span><span class="o">.</span><span class="nf">current</span><span class="p">()</span><span class="o">.</span><span class="nf">play</span><span class="p">(</span><span class="o">.</span><span class="n">notification</span><span class="p">)</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"totalCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
        <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"plusCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span><span class="p">,</span> <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span> <span class="o">!=</span> <span class="n">plusCount</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span>
        <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="k">let</span> <span class="nv">targetCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"targetCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span><span class="p">,</span> <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span> <span class="o">!=</span> <span class="n">targetCount</span> <span class="p">{</span>
        <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span> <span class="o">=</span> <span class="n">targetCount</span>
        <span class="c1">// reloadComplicationTimeline()</span>
        
        <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Target: </span><span class="se">\(</span><span class="n">targetCount</span><span class="o">.</span><span class="n">intText</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="o">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<h3 id="통신-과정이-추가된-interfacecontrollerswift-전체-코드"><span class="me-2"><strong>통신 과정이 추가된 <em>InterfaceController.swift</em> 전체 코드</strong></span><a href="#통신-과정이-추가된-interfacecontrollerswift-전체-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
</pre></td><td class="rouge-code"><pre><span class="kd">import</span> <span class="kt">WatchKit</span>
<span class="kd">import</span> <span class="kt">Foundation</span>
<span class="kd">import</span> <span class="kt">WatchConnectivity</span>
<span class="kd">import</span> <span class="kt">ClockKit</span>

<span class="kd">struct</span> <span class="kt">CurrentData</span> <span class="p">{</span>
    
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">shared</span> <span class="o">=</span> <span class="kt">CurrentData</span><span class="p">(</span><span class="nv">currentTotalCount</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">targetCount</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    
    <span class="k">var</span> <span class="nv">currentTotalCount</span><span class="p">:</span> <span class="kt">Double</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">targetCount</span><span class="p">:</span> <span class="kt">Double</span><span class="p">?</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">InterfaceController</span><span class="p">:</span> <span class="kt">WKInterfaceController</span> <span class="p">{</span>
    
    <span class="kd">enum</span> <span class="kt">LabelStatus</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">stepValue</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">error</span>
    <span class="p">}</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">lblTotalCount</span><span class="p">:</span> <span class="kt">WKInterfaceLabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">lblStatus</span><span class="p">:</span> <span class="kt">WKInterfaceLabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">btnMinus</span><span class="p">:</span> <span class="kt">WKInterfaceButton</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">btnPlus</span><span class="p">:</span> <span class="kt">WKInterfaceButton</span><span class="o">!</span>
    
    <span class="c1">// 1: Session property</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">WCSession</span><span class="o">.</span><span class="k">default</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">totalCount</span><span class="p">:</span> <span class="kt">Double</span><span class="o">!</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">plusCount</span><span class="p">:</span> <span class="kt">Double</span><span class="o">!</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">initTotalCountLoaded</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">initPlusCountLoaded</span> <span class="o">=</span> <span class="kc">false</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awake</span><span class="p">(</span><span class="n">withContext</span> <span class="nv">context</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?)</span> <span class="p">{</span>
        <span class="c1">// Configure interface objects here.</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">willActivate</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// This method is called when watch view controller is about to be visible to user</span>
        
        <span class="c1">// 2: Initialization of session and set as delegate this InterfaceController if it's supported</span>
        <span class="k">if</span> <span class="kt">WCSession</span><span class="o">.</span><span class="nf">isSupported</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">session</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
            <span class="n">session</span><span class="o">.</span><span class="nf">activate</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="kt">Timer</span><span class="o">.</span><span class="nf">scheduledTimer</span><span class="p">(</span><span class="nv">withTimeInterval</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nv">repeats</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">timer</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"timer"</span><span class="p">,</span> <span class="k">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">isReachable</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">isReachable</span> <span class="p">{</span>
                <span class="nf">fetchDataFromRootDevice</span><span class="p">()</span>
                <span class="n">timer</span><span class="o">.</span><span class="nf">invalidate</span><span class="p">()</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">,</span> <span class="s">"iPhone is not reachable!!"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">didDeactivate</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// This method is called when watch view controller is no longer visible</span>
        <span class="nf">reloadComplicationTimeline</span><span class="p">()</span>
        
    <span class="p">}</span>
    
    <span class="c1">// MARK: - UI Helper</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">turnAllButton</span><span class="p">(</span><span class="n">_</span> <span class="nv">isEnable</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">btnPlus</span><span class="o">.</span><span class="nf">setEnabled</span><span class="p">(</span><span class="n">isEnable</span><span class="p">)</span>
        <span class="n">btnMinus</span><span class="o">.</span><span class="nf">setEnabled</span><span class="p">(</span><span class="n">isEnable</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">_</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="kt">UIColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">lblTotalCount</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">lblTotalCount</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setStatus</span><span class="p">(</span><span class="n">_</span> <span class="nv">status</span><span class="p">:</span> <span class="kt">LabelStatus</span><span class="p">,</span> <span class="n">_</span> <span class="nv">text</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">status</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">stepValue</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="s">"Step Value: </span><span class="se">\(</span><span class="n">text</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">normal</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">error</span><span class="p">:</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setTextColor</span><span class="p">(</span><span class="o">.</span><span class="n">red</span><span class="p">)</span>
            <span class="n">lblStatus</span><span class="o">.</span><span class="nf">setText</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">text</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - Handle Watch's system</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">requestChangeTotalCount</span><span class="p">(</span><span class="n">_</span> <span class="nv">request</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(),</span> <span class="nv">failedHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">())</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">isReachable</span> <span class="p">{</span>
            <span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequest</span><span class="p">(</span><span class="s">"totalCount_</span><span class="se">\(</span><span class="n">request</span><span class="se">)</span><span class="s">"</span><span class="p">))</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>
                
                <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"response"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
                    <span class="c1">// Set CurrentData</span>
                    <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Request success:"</span><span class="p">,</span> <span class="n">totalCount</span><span class="p">)</span>
                    <span class="nf">completionHandler</span><span class="p">()</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed:"</span><span class="p">,</span> <span class="k">#line</span><span class="p">)</span>
                    <span class="nf">failedHandler</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending message: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="nf">failedHandler</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Request failed:"</span><span class="p">,</span> <span class="k">#line</span><span class="p">)</span>
            <span class="nf">failedHandler</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">fetchDataFromRootDevice</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">isReachable</span> <span class="p">{</span>
            <span class="nf">turnAllButton</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
            
            <span class="nf">setCountLabel</span><span class="p">(</span><span class="s">"..."</span><span class="p">)</span>
            <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Loading status..."</span><span class="p">)</span>
            
            <span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequest</span><span class="p">(</span><span class="s">"plusCount_get"</span><span class="p">))</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"response"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">initPlusCountLoaded</span> <span class="o">=</span> <span class="kc">true</span>
                    <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">initTotalCountLoaded</span> <span class="p">{</span>
                        <span class="k">self</span><span class="o">.</span><span class="nf">turnAllButton</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="s">"Unknown"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending message: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequest</span><span class="p">(</span><span class="s">"totalCount_get"</span><span class="p">))</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"response"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">initTotalCountLoaded</span> <span class="o">=</span> <span class="kc">true</span>
                    <span class="c1">// Set CurrentData</span>
                    <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
                    <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">initPlusCountLoaded</span> <span class="p">{</span>
                        <span class="k">self</span><span class="o">.</span><span class="nf">turnAllButton</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="s">"ERROR"</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">red</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending message: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">setCountLabel</span><span class="p">(</span><span class="s">"ERROR"</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">red</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="n">session</span><span class="o">.</span><span class="nf">sendMessage</span><span class="p">(</span><span class="nf">makeRequest</span><span class="p">(</span><span class="s">"targetCount_get"</span><span class="p">))</span> <span class="p">{</span> <span class="n">response</span> <span class="k">in</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">targetCount</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"response"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
                    <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span> <span class="o">=</span> <span class="n">targetCount</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">reloadComplicationTimeline</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">complication</span> <span class="o">=</span> <span class="kt">CLKComplicationServer</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="n">activeComplications</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
            <span class="kt">CLKComplicationServer</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">reloadTimeline</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">complication</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - @IBActions</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActRefresh</span><span class="p">()</span> <span class="p">{</span>
       <span class="nf">fetchDataFromRootDevice</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActMinus</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">)</span>
        <span class="c1">// 시계 디스플레이는 plusCount 만큼 일단 올리고</span>
        <span class="c1">// 맞으면 확정 표시</span>
        <span class="c1">// 틀리면 롤백</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">-</span> <span class="n">plusCount</span>
        <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">darkGray</span><span class="p">)</span>
        <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Syncing..."</span><span class="p">)</span>
        
        <span class="nf">requestChangeTotalCount</span><span class="p">(</span><span class="s">"minus"</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
            <span class="c1">// Set CurrentData</span>
            <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
        <span class="p">}</span> <span class="nv">failedHandler</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">+</span> <span class="n">plusCount</span>
            <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">btnActPlus</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">)</span>
        <span class="c1">// 시계 디스플레이는 plusCount 만큼 일단 올리고</span>
        <span class="c1">// 맞으면 확정 표시</span>
        <span class="c1">// 틀리면 롤백</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">+</span> <span class="n">plusCount</span>
        <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">,</span> <span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="n">darkGray</span><span class="p">)</span>
        <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Syncing..."</span><span class="p">)</span>
        
        <span class="nf">requestChangeTotalCount</span><span class="p">(</span><span class="s">"plus"</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
            <span class="c1">// Set CurrentData</span>
            <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
        <span class="p">}</span> <span class="nv">failedHandler</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">-</span> <span class="n">plusCount</span>
            <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">InterfaceController</span><span class="p">:</span> <span class="kt">WCSessionDelegate</span> <span class="p">{</span>
    
    <span class="c1">// MARK: - WCSessionDelegate</span>
    
    <span class="c1">// 4: Required stub for delegating session</span>
    <span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">activationDidCompleteWith</span> <span class="nv">activationState</span><span class="p">:</span> <span class="kt">WCSessionActivationState</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">Error</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"activationDidCompleteWith activationState:</span><span class="se">\(</span><span class="n">activationState</span><span class="se">)</span><span class="s"> error:</span><span class="se">\(</span><span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="n">error</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// Receive messages from iPhone</span>
    <span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">didReceiveMessage</span> <span class="nv">message</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">])</span> <span class="p">{</span>
        <span class="c1">// 1: We launch a sound and a vibration</span>
        <span class="kt">WKInterfaceDevice</span><span class="o">.</span><span class="nf">current</span><span class="p">()</span><span class="o">.</span><span class="nf">play</span><span class="p">(</span><span class="o">.</span><span class="n">notification</span><span class="p">)</span>
    
        <span class="nf">print</span><span class="p">(</span><span class="k">#function</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"totalCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
            <span class="nf">setCountLabel</span><span class="p">(</span><span class="n">totalCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="k">let</span> <span class="nv">plusCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"plusCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span><span class="p">,</span> <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span> <span class="o">!=</span> <span class="n">plusCount</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span> <span class="o">=</span> <span class="n">plusCount</span>
            <span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="k">let</span> <span class="nv">targetCount</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s">"targetCount"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Double</span><span class="p">,</span> <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span> <span class="o">!=</span> <span class="n">targetCount</span> <span class="p">{</span>
            <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span> <span class="o">=</span> <span class="n">targetCount</span>
            <span class="c1">// reloadComplicationTimeline()</span>
            
            <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s">"Target: </span><span class="se">\(</span><span class="n">targetCount</span><span class="o">.</span><span class="n">intText</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="o">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">setStatus</span><span class="p">(</span><span class="o">.</span><span class="n">stepValue</span><span class="p">,</span> <span class="k">self</span><span class="o">.</span><span class="n">plusCount</span><span class="o">.</span><span class="n">intText</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">session</span><span class="p">(</span><span class="n">_</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">WCSession</span><span class="p">,</span> <span class="n">didReceiveUserInfo</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:])</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"received UserInfo:"</span><span class="p">,</span> <span class="n">userInfo</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<h3 id="5-컴플리케이션-제작"><span class="me-2"><strong>5) 컴플리케이션 제작</strong></span><a href="#5-컴플리케이션-제작" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>컴플리케이션은 굉장히 많은 종류가 있는데, 시간 제한상 <code class="language-plaintext highlighter-rouge">CLKComplicationTemplateCircularSmallRingText</code> 한 가지만 제작합니다.</li>
  <li>컴플리케이션은 C<strong><em>omplicationController.swift</em></strong>에서 다루게 됩니다.</li>
  <li>컴플리키에션 구현에는 복잡한 특징이 있습니다.
    <ul>
      <li>컴플리케이션의 변화 내용을 앱이 실행된 때에 미리 타임라인 형태로 예약해서 등록합니다.</li>
      <li>애플 워치의 과도한 작업으로 인한 성능 저하 및 배터리 누수를 막기 위해 특정 시간동안 표시할 수 있는 내용을 100회로 제한합니다.</li>
      <li>컴플리케이션의 내용에 따라 앱이 실행된 때에만 업데이트가 한 번 필요한 경우 또는 앱이 실행 후 일정 시간동안 컴플리케이션을 여러 번 업데이트해야 하는 경우가 있습니다.</li>
      <li>전자의 경우 타임라인을 사용하지 않으며, 타임라인을 사용하지 않더라도 컴플리케이션의 표시 날짜(<code class="language-plaintext highlighter-rouge">Date</code>)는 등록해야 합니다.</li>
      <li>타임라인을 사용할 경우 타임라인의 종료 시간을 시스템에 미리 알려줘야 됩니다.</li>
    </ul>
  </li>
</ul>

<p> </p>

<p><a href="/assets/img/wp-content/uploads/2022/09/timeline-1.png" class="popup img-link shimmer"><img src="/assets/img/wp-content/uploads/2022/09/timeline-1.png" alt="" loading="lazy"></a><br />
<em>컴플리케이션의 타임라인 예시. 5분 간격으로 업데이트할 정보를 미리 등록합니다.</em></p>

<p> </p>

<p> </p>

<ul>
  <li>먼저 <code class="language-plaintext highlighter-rouge">CLKComplicationTemplate</code>을 반환하는 함수들을 추가합니다.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">CLKComplicationTemplate</code>는 실제로 애플 워치 화면에 표시되는 컴플리케이션의 UI 인스턴스입니다.</li>
      <li>
        <p>그래픽이 포함된 컴플리케이션은 SwiftUI의 <code class="language-plaintext highlighter-rouge">View</code>를 이용합니다. 예제 코드는 다음과 같습니다.</p>

        <div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>  case .graphicCircular:
              return CLKComplicationTemplateGraphicCircularView(ComplicationViewCircular(current: current, target: target))
        
  // ================ Swift UI 부분 ================ //
        
  import SwiftUI
  import ClockKit
        
  struct ComplicationViewCircular: View {
      @State var current: Double
      @State var target: Double
            
      var body: some View {...}
  }
        
</pre></td></tr></tbody></table></code></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">CLKComplicationTemplate</code>를 나중에 컴플레이케이션 표시 시간을 정하는 딜리게이트 메소드에서 지정합니다.</li>
    </ul>
  </li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="kd">extension</span> <span class="kt">ComplicationController</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="nf">makeTemplate</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">,</span> <span class="nv">complication</span><span class="p">:</span> <span class="kt">CLKComplication</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CLKComplicationTemplate</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">complication</span><span class="o">.</span><span class="n">family</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">circularSmall</span><span class="p">:</span>
            <span class="k">return</span> <span class="kt">CLKComplicationTemplateCircularSmallRingImage</span><span class="p">(</span><span class="nv">imageProvider</span><span class="p">:</span> <span class="kt">CLKImageProvider</span><span class="p">(</span><span class="nv">onePieceImage</span><span class="p">:</span> <span class="n">image</span><span class="p">),</span> <span class="nv">fillFraction</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="nv">ringStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">makeTemplate</span><span class="p">(</span><span class="nv">current</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span> <span class="nv">target</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span> <span class="nv">complication</span><span class="p">:</span> <span class="kt">CLKComplication</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">CLKComplicationTemplate</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">percentage</span> <span class="o">=</span> <span class="n">current</span> <span class="o">/</span> <span class="n">target</span>
        
        <span class="k">switch</span> <span class="n">complication</span><span class="o">.</span><span class="n">family</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">circularSmall</span><span class="p">:</span>
            <span class="k">return</span> <span class="kt">CLKComplicationTemplateCircularSmallRingText</span><span class="p">(</span><span class="nv">textProvider</span><span class="p">:</span> <span class="kt">CLKTextProvider</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="n">current</span><span class="o">.</span><span class="n">rationalizedText</span><span class="p">),</span> <span class="nv">fillFraction</span><span class="p">:</span> <span class="kt">Float</span><span class="p">(</span><span class="n">percentage</span><span class="p">),</span> <span class="nv">ringStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">closed</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<p><strong>기본 컴플리케이션 표시</strong></p>

<ul>
  <li>다음 <code class="language-plaintext highlighter-rouge">func getCurrentTimelineEntry(...withHandler...)</code>에 기본 컴플리케이션을 추가합니다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getCurrentTimelineEntry</span><span class="p">(</span><span class="k">for</span> <span class="nv">complication</span><span class="p">:</span> <span class="kt">CLKComplication</span><span class="p">,</span> <span class="n">withHandler</span> <span class="nv">handler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">CLKComplicationTimelineEntry</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Call the handler with the current timeline entry</span>
    
    <span class="k">if</span> <span class="k">let</span> <span class="nv">template</span> <span class="o">=</span> <span class="nf">makeTemplate</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="s">"star.fill"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span> <span class="nv">complication</span><span class="p">:</span> <span class="n">complication</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">entry</span> <span class="o">=</span> <span class="kt">CLKComplicationTimelineEntry</span><span class="p">(</span><span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span><span class="p">(),</span> <span class="nv">complicationTemplate</span><span class="p">:</span> <span class="n">template</span><span class="p">)</span>
        <span class="nf">handler</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">handler</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CLKComplicationTimelineEntry</code>
    <ul>
      <li>특정 시간대의 타임라인에 진입해 컴플리케이션을 표시합니다.</li>
      <li>기본 컴플리케이션은 별표(★)만 표시합니다.</li>
      <li><code class="language-plaintext highlighter-rouge">date</code>에는 현재 순간을 의미하는 <code class="language-plaintext highlighter-rouge">Date()</code>를 입력합니다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">handler(entry)</code>를 실행되는 순간 컴플리케이션이 표시됩니다.</li>
</ul>

<p> </p>

<p><strong>업데이트된 정보의 컴플리케이션 표시</strong></p>

<ul>
  <li>미래에 업데이트될 정보는 <code class="language-plaintext highlighter-rouge">func getTimeEntries(for...after...limit...)</code>에서 실행합니다.</li>
  <li>이 앱에서는 아이폰 앱과의 통신 과정이 있으며, 앱이 실행된 순간 바로 정보를 알 수 있는게 아니고 아이폰으로부터 정보를 받아온 뒤 정보를 알 수 있는데, 그 과정에서 약간의 시간이 소요됩니다.</li>
  <li>타이머를 돌려서 데이터가 <code class="language-plaintext highlighter-rouge">nil</code>이 아닌 경우(=데이터를 받아온 경우) 그 순간에 업데이트된 컴플리케이션 정보를 미래 엔트리에 등록합니다.</li>
  <li>이렇게 하면 앱을 닫은 후에도 컴플리케이션 정보가 업데이트됩니다.</li>
</ul>

<!-- http://www.giphy.com/gifs/4U2ZIdxnTkaPtPwWI7 -->
<p><a href="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjF4a2xqcWQzMnE3NnMzcTY1MnUyb2F0em4xaDlubXdvZTM3OGM3ciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" class="popup img-link shimmer"><img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjF4a2xqcWQzMnE3NnMzcTY1MnUyb2F0em4xaDlubXdvZTM3OGM3ciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/4U2ZIdxnTkaPtPwWI7/giphy.gif" alt="" loading="lazy"></a></p>

<p><em>버튼을 눌러 앱을 닫으면, 처음에는 기본 내용 별표(★)가 표시되었다가 잠시 뒤 정보가 업데이트되면 별표가 사라지고 해당 정보로 업데이트됩니다.</em></p>

<p> </p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getTimelineEntries</span><span class="p">(</span><span class="k">for</span> <span class="nv">complication</span><span class="p">:</span> <span class="kt">CLKComplication</span><span class="p">,</span> <span class="n">after</span> <span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span><span class="p">,</span> <span class="nv">limit</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="n">withHandler</span> <span class="nv">handler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">([</span><span class="kt">CLKComplicationTimelineEntry</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Call the handler with the timeline entries after the given date</span>

    <span class="k">var</span> <span class="nv">dataRead</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="kt">Timer</span><span class="o">.</span><span class="nf">scheduledTimer</span><span class="p">(</span><span class="nv">withTimeInterval</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nv">repeats</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">self</span><span class="p">]</span> <span class="n">timer</span> <span class="k">in</span>
        
        <span class="k">if</span> <span class="n">dataRead</span> <span class="p">{</span>
            <span class="n">timer</span><span class="o">.</span><span class="nf">invalidate</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="k">var</span> <span class="nv">entries</span><span class="p">:</span> <span class="p">[</span><span class="kt">CLKComplicationTimelineEntry</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">if</span> <span class="k">let</span> <span class="nv">totalCount</span> <span class="o">=</span> <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">currentTotalCount</span><span class="p">,</span>
           <span class="k">let</span> <span class="nv">targetCount</span> <span class="o">=</span> <span class="kt">CurrentData</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">targetCount</span><span class="p">,</span>
           <span class="k">let</span> <span class="nv">template</span> <span class="o">=</span> <span class="nf">makeTemplate</span><span class="p">(</span><span class="nv">current</span><span class="p">:</span> <span class="n">totalCount</span><span class="p">,</span> <span class="nv">target</span><span class="p">:</span> <span class="n">targetCount</span><span class="p">,</span> <span class="nv">complication</span><span class="p">:</span> <span class="n">complication</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">entry</span> <span class="o">=</span> <span class="kt">CLKComplicationTimelineEntry</span><span class="p">(</span>
                <span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span><span class="p">(),</span>
                <span class="nv">complicationTemplate</span><span class="p">:</span> <span class="n">template</span><span class="p">)</span>
            <span class="n">entries</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            
            <span class="n">dataRead</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="n">timer</span><span class="o">.</span><span class="nf">invalidate</span><span class="p">()</span>
            <span class="nf">handler</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">handler(entries)</code>가 실행되는 순간 미래의 타임라인 엔트리가 등록됩니다.
    <ul>
      <li>앱 시작 후 바로 등록될 필요는 없으며, 시간차를 두고 등록해도 됩니다. (예: 네트워크 서버로부터 비동기로 데이터를 받아왔을 때 실행)</li>
    </ul>
  </li>
</ul>

<p> </p>

<ul>
  <li>마지막으로, 시스템에 타임라인 종료 시점을 알려줍니다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getTimelineEndDate</span><span class="p">(</span><span class="k">for</span> <span class="nv">complication</span><span class="p">:</span> <span class="kt">CLKComplication</span><span class="p">,</span> <span class="n">withHandler</span> <span class="nv">handler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Date</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Call the handler with the last entry date you can currently provide or nil if you can't support future timelines</span>
    <span class="k">let</span> <span class="nv">after</span> <span class="o">=</span> <span class="kt">Date</span><span class="p">()</span><span class="o">.</span><span class="n">timeIntervalSince1970</span> <span class="o">+</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span>
    <span class="nf">handler</span><span class="p">(</span><span class="kt">Date</span><span class="p">(</span><span class="nv">timeIntervalSince1970</span><span class="p">:</span> <span class="n">after</span><span class="p">))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>이 메소드의 목적은 다른 앱들로부터 컴플리케이션 스케줄을 분석해 시스템의 자원 사용량을 미리 계산해 최적화하기 위함이라고 합니다.
    <ul>
      <li>이 시간이 지나면 업데이트 작업을 수행하지 않습니다.</li>
    </ul>
  </li>
  <li>앱 실행 후 한 시간 뒤를 타임라인 종료 시점이라고 알려줍니다.
    <ul>
      <li>이 앱은 타임라인의 종료 시간을 알 수 없기 때문에 한 시간이라고 하였지만, 보통은 타임라인의 마지막 시간을 입력합니다.</li>
    </ul>
  </li>
  <li>타임라인이 존재하지 않으면 <code class="language-plaintext highlighter-rouge">handler(nil)</code>을 입력합니다.</li>
</ul>

<p> </p>

<h4 id="앱을-닫을-때마다-타임라인-업데이트"><span class="me-2"><strong>앱을 닫을 때마다 타임라인 업데이트</strong></span><a href="#앱을-닫을-때마다-타임라인-업데이트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>타임라인은 홈 버튼을 눌러 앱을 닫는 시점마다 갱신되어야 합니다. 인터페이스 컨트롤러 코드의 didDeactivate() 부분에 다음 내용을 추가합니다. (<code class="language-plaintext highlighter-rouge">reloadTimeline</code>은 WatchOS 9 이후 Deprecate 예정)
    <ul>
      <li><code class="language-plaintext highlighter-rouge">CLKComplicationServer.sharedInstance().reloadTimeline(for: complication)</code></li>
    </ul>
  </li>
  <li>if문으로 내용의 변경이 있을때만 업데이트를 실행하도록하면 시스템 자원을 덜 사용할 수 있습니다.</li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/devlog/">DevLog</a>,
          <a href="/categories/%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4/">포트폴리오</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Swift%20%EC%98%88%EC%A0%9C:%20iOS%20+%20WatchOS%20%EC%97%B0%EB%8F%99%20%EC%95%B1%20LinkedCounter%20(%EC%A3%BC%EC%9A%94%20%EA%B0%9C%EB%B0%9C%20%EA%B3%BC%EC%A0%95%20%EC%9A%94%EC%95%BD)%20-%20BGSMM&url=https%3A%2F%2Fayaysir.github.io%2Fposts%2Fswift-%25EC%2598%2588%25EC%25A0%259C-ios-watchos-%25EC%2597%25B0%25EB%258F%2599-%25EC%2595%25B1-linkedcounter-%25EC%25A3%25BC%25EC%259A%2594-%25EA%25B0%259C%25EB%25B0%259C-%25EA%25B3%25BC%25EC%25A0%2595-%25EC%259A%2594%25EC%2595%25BD%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Swift%20%EC%98%88%EC%A0%9C:%20iOS%20+%20WatchOS%20%EC%97%B0%EB%8F%99%20%EC%95%B1%20LinkedCounter%20(%EC%A3%BC%EC%9A%94%20%EA%B0%9C%EB%B0%9C%20%EA%B3%BC%EC%A0%95%20%EC%9A%94%EC%95%BD)%20-%20BGSMM&u=https%3A%2F%2Fayaysir.github.io%2Fposts%2Fswift-%25EC%2598%2588%25EC%25A0%259C-ios-watchos-%25EC%2597%25B0%25EB%258F%2599-%25EC%2595%25B1-linkedcounter-%25EC%25A3%25BC%25EC%259A%2594-%25EA%25B0%259C%25EB%25B0%259C-%25EA%25B3%25BC%25EC%25A0%2595-%25EC%259A%2594%25EC%2595%25BD%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fayaysir.github.io%2Fposts%2Fswift-%25EC%2598%2588%25EC%25A0%259C-ios-watchos-%25EC%2597%25B0%25EB%258F%2599-%25EC%2595%25B1-linkedcounter-%25EC%25A3%25BC%25EC%259A%2594-%25EA%25B0%259C%25EB%25B0%259C-%25EA%25B3%25BC%25EC%25A0%2595-%25EC%259A%2594%25EC%2595%25BD%2F&text=Swift%20%EC%98%88%EC%A0%9C:%20iOS%20+%20WatchOS%20%EC%97%B0%EB%8F%99%20%EC%95%B1%20LinkedCounter%20(%EC%A3%BC%EC%9A%94%20%EA%B0%9C%EB%B0%9C%20%EA%B3%BC%EC%A0%95%20%EC%9A%94%EC%95%BD)%20-%20BGSMM" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/xcode-where-is-infoplist/">Xcode 에서 Info.plist 파일이 없을 때</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/swift-urlscheme/">Swift: iOS에서 Custom URL Scheme 등록해서 url로 앱 열기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/swift-translation/">SwiftUI: 번역 기능 (Translation) 사용하기 (iOS 18 이상)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/swift-extensioncontext-error-ios18/">Swift: Action Extension에서 extensionContext가 iOS 18에서 작동하지 않는 문제</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/swift-action-extension/">Swift: Action Extension으로 사진을 내 앱으로 전송하기</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/audiokit/">AudioKit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9D%8C%ED%96%A5%EC%9D%B4%EB%A1%A0/">음향이론</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8/">자바스크립트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spring-boot/">spring-boot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vue-js/">vue-js</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qbasic-%EA%B8%B0%EC%B4%88/">qbasic-기초</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/macos-%EC%95%B1-%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4-%ED%94%8C%EB%A0%88%EC%9D%B8-%ED%85%8D%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9E%91%EC%84%B1-%EA%B4%80%EB%A6%AC%ED%95%A0-%EC%88%98-%EC%9E%88/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745247600"
  data-df="ll"
  
>
  Apr 22, 2025
</time>

              <h4 class="pt-0 my-2">macOS 앱 포트폴리오: 플레인 텍스트를 작성/관리할 수 있는 포스트잇 앱 (애플 앱스토어 출시 💻)</h4>
              <div class="text-muted">
                <p>## **StickyPlainPad**  StickyPlainPad는 플레인 텍스트(서식 없는 텍스트)를 포스트잇처럼 맥 여기저기에 붙였다 뗐다 사용할 수 있는 메모 앱입니다.   {% raw %}         Instagram에서 이 게시물 보기            BGSMM(@bgsmm.dev)님의 공유 게시물  {% endraw %}  ## *...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%9D%8C%EC%95%85-%ED%95%99%EC%8A%B5-%EC%95%B1-%EC%B6%9C%EC%8B%9C-music-interval-quiz-master%EB%A1%9C-%EA%B3%A8%EC%B9%98%EC%95%84%ED%94%88-%EC%9D%8C%EC%A0%95-%EC%A0%95/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1733324400"
  data-df="ll"
  
>
  Dec  5, 2024
</time>

              <h4 class="pt-0 my-2">새로운 음악 학습 앱 출시: Music Interval Quiz Master로 골치아픈 음정 정복!</h4>
              <div class="text-muted">
                <p>**Music Interval Quiz Master**   ![](/assets/img/wp-content/uploads/2024/12/screenshot-2024-12-05-pm-9.40.35-copy.jpg)  **[여기를 눌러 설치](https://apps.apple.com/kr/app/music-interval-quiz-master/id6738...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ios-%EC%95%B1-%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4-%EC%9D%8C%EC%95%85-%EC%8A%A4%EC%BC%80%EC%9D%BC%EC%9D%8C%EA%B3%84-%ED%95%99%EC%8A%B5-%EB%8F%84%EC%9A%B0%EB%AF%B8-%EC%95%B1-ultimatescale/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1657465200"
  data-df="ll"
  
>
  Jul 11, 2022
</time>

              <h4 class="pt-0 my-2">iOS 앱 포트폴리오: 음악 스케일(음계) 학습 도우미 앱 UltimateScale 애플 앱스토어 출시 📱</h4>
              <div class="text-muted">
                <p>UltimateScale  UtimateScale은 음악 스케일(음계) 학습 도우미입니다.  App Store 링크  UltimateScale 한국 앱 스토어 링크 (모든 국가 출시)     깃허브 링크  https://github.com/ayaysir/MusicScale     특징 및 사용 기술     애플 앱스토어의 검수에 통과하였습니다.   C...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/%EC%95%84%EC%9D%B4%ED%8F%B0-%EC%95%84%EC%9D%B4%ED%8C%A8%EB%93%9C-%EC%95%B1-%EB%82%98%EB%A7%8C%EC%9D%98-%EC%98%A4%EB%A5%B4%EA%B3%A8-%EB%A7%8C%EB%93%A4%EA%B8%B0make-my-musicbox-%EB%B2%84%EC%A0%84/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>[아이폰/아이패드 앱] 나만의 오르골 만들기(Make My MusicBox) 버전 업데이트 (1.03.1)</p>
    </a>
  

  
    <a
      href="/posts/php-cors-%EC%97%90%EB%9F%AC%EB%A5%BC-%ED%9A%8C%ED%94%BC%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%9C-api%EC%9D%98-%ED%94%84%EB%A1%9D%EC%8B%9C%EC%A4%91%EA%B3%84-%ED%8E%98%EC%9D%B4%EC%A7%80-%EB%A7%8C/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>PHP: CORS 에러를 회피하기 위한 API의 프록시(중계) 페이지 만들기 (cURL 이용)</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/ayaysir">ayaysir</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/audiokit/">AudioKit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9D%8C%ED%96%A5%EC%9D%B4%EB%A1%A0/">음향이론</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8/">자바스크립트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/spring-boot/">spring-boot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vue-js/">vue-js</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%9E%90%EB%B0%94/">자바</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/opengl/">opengl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/qbasic-%EA%B8%B0%EC%B4%88/">qbasic-기초</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script>
  (function () {
    const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed');
    const initTheme = themeMapper[Theme.visualState];

    let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) {
      lang = lang.slice(0, 2);
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'ayaysir/ayaysir.github.io',
      'data-repo-id': 'R_kgDOOurl2w',
      'data-category': 'General',
      'data-category-id': 'DIC_kwDOOurl284CxFIa',
      'data-mapping': 'pathname',
      'data-strict' : '0',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': lang,
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusNode = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusNode.setAttribute(key, value)
    );

    const $footer = document.querySelector('footer');
    $footer.insertAdjacentElement("beforebegin", giscusNode);

    addEventListener('message', (event) => {
      if (event.source === window && event.data && event.data.id === Theme.ID) {
        const newTheme = themeMapper[Theme.visualState];

        const message = {
          setConfig: {
            theme: newTheme
          }
        };

        const giscus =
          document.getElementsByClassName('giscus-frame')[0].contentWindow;
        giscus.postMessage({ giscus: message }, 'https://giscus.app');
      }
    });
  })();
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

